# Map Rendering Service

## Обзор
Map Rendering Service - это микросервис, использующий технологии Spring Cloud, 
Project Reactor, R2DBC и Java2D для рендеринга географических данных. 
Включает основные микросервисы: Gateway, Discovery, Config и Rendering.

## Начало работы


### Установка и Настройка
1. Установите Docker на свой компьютер, если его еще нет.
   Посетите веб-сайт Docker (https://www.docker.com/) и следуйте
   инструкциям по установке для вашей операционной системы.

2. Клонируйте репозиторий на свой локальный компьютер:

```
git clone https://github.com/Alura555/map-rendering.git
```
3. Перейдите в каталог проекта:

```
cd map-rendering
```

### Сборка и Запуск
1. Соберите Docker-образы с использованием Docker Compose:

```
docker-compose build
```
2. Запустите контейнеры:

```
docker-compose up -d
```
3. После того как контейнеры запущены,
   для получения доступа к приложению требуется перейти по адресу http://localhost:8080.

### Остановка приложения
Чтобы остановить приложение, выполните следующую команду:

```
docker-compose down
```
### Удаление контейнеров
Если вы хотите удалить Docker-контейнеры и образы, связанные с приложением, выполните следующую команду:

```
docker-compose down --volumes --rmi all
```

## Контейнеры
### 1. Gateway Service
Gateway Service представляет собой компонент, отвечающий за маршрутизацию 
запросов в микросервисной архитектуре приложения. 
Он используется для обеспечения доступа к различным микросервисам и 
предоставляет единый точку входа (API Gateway) для клиентов приложения.

После развертывания Gateway Service будет доступен по адресу http://localhost:4000. 
Пример запроса, который будет перенаправлен 
на Map Rendering Service, будет выглядеть следующим образом:

```
GET http://localhost:4000/map-rendering/objects?width=800&height=600&bbox=0,0,50000,50000
```

В запросе указываются следующие параметры:
* **width** - ширина изображения;
* **height** - высота изображения;
* **bbox** - прямоугольная область, в которой находятся объекты для отображения (в координатах 3857).

### 2. Discovery Service

Discovery Service, основанный на Spring Cloud Eureka, представляет собой сервис 
регистрации и обнаружения других сервисов в микросервисной архитектуре.

Для получения доступа к панели администрирования Eureka требуется перейти 
по адресу: http://localhost:8761


### 3. Config Service
Config Service - это микросервис, основанный на Spring Cloud Config, 
предназначенный для централизованного хранения и управления конфигурационными 
файлами для остальных микросервисов.

Проверить работу микросервиса можно с помощью получения доступа к actuator, 
для этого требуется перейти по адресу: http://localhost:8888/actuator


### 4. Map Rendering Service
Map Rendering Service - это микросервис, предназначенный для рендеринга карт и 
отображения объектов на основе входных параметров. 

Для хранение объектов была использвоана СУБД PostgreSQL с расширением PostGIS.  
В базе данных хранятся идентификатор, геометрия, цветоопределяющая характеристика.

Для взаимодействия с Map Rendering Service необходимо выполнить HTTP-запрос 
по адресу http://localhost:6060 и передать следующие параметры:
* **width** - ширина изображения;
* **height** - высота изображения;
* **bbox** - прямоугольная область, в которой находятся объекты для отображения (в координатах 3857).

Пример запроса:

```
GET http://localhost:6060/render?width=800&height=600&bbox=0,0,50000,50000
```
В ответе будет получен список объектов, находящихся в указанной области.

### PostgreSQL
Контейнер с базой данных предназначен для хранения географических
объектов и их координат. В данном случае, используется образ 
PostgreSQL с расширением PostGIS для поддержки геоданных.


### Web

Данный контейнер работает в качестве точки входа для 
использования сервиса рендеринга данных. Содержит основную 
HTML-страницу и JavaScript-код для отображения
карты с использованием OpenLayers. Для доступа к приложению 
требуется перейти по адресу http://localhost:8080, а так же указать 
параметры запроса